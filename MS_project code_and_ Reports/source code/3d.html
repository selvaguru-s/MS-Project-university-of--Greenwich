<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-54B4T8F');</script>
  <!-- End Google Tag Manager -->

    <link rel="stylesheet" href="mainpage-style.css">
    <title>Mian Page</title>  
</head>
<body>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-54B4T8F"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->



<div class="row" >
	<div class="column">
<canvas id="c"></canvas>

<div id="info">
  <div id="top">
    <a id="close" href="">&times;</a>
  </div>
  <p>
    <br>Tear the cloth with your mouse

    <div class="center">
      
  </div>
    <br>
  </p>
</div></div>
	<div class="column">
		
<h2 style="text-align: center;">Add your photo to see virtual cloth wearing!</h2>
<script class="jsbin" src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<div class="file-upload">
  <button class="file-upload-btn user_uploads_his_photo"  type="button" id="mainBtn">Add Image</button>

  <div class="image-upload-wrap">
    <input class="file-upload-input" type='file' onchange="readURL(this);" accept="image/*" />
    <div class="drag-text">
      <h3>Drag and drop a file or select add Image</h3>
    </div>
  </div>
  <div class="file-upload-content">
    <img class="file-upload-image" src="#" alt="your image" />
    <div class="image-title-wrap">
      <button type="button" onclick="removeUpload()" class="remove-image">Remove <span class="image-title">Uploaded Image</span></button>
    </div>
  </div>
</div>
	</div>

</div>






<script>document.getElementById('close').onmousedown = function(e) {
	e.preventDefault();
	document.getElementById('info').style.display = 'none';
	return false;
  };
  
  // settings
  
  var physics_accuracy  = 3,
	  mouse_influence   = 20,
	  mouse_cut         = 5,
	  gravity           = 1200,
	  cloth_height      = 30,
	  cloth_width       = 50,
	  start_y           = 20,
	  spacing           = 7,
	  tear_distance     = 60;
  
  
  window.requestAnimFrame =
	  window.requestAnimationFrame ||
	  window.webkitRequestAnimationFrame ||
	  window.mozRequestAnimationFrame ||
	  window.oRequestAnimationFrame ||
	  window.msRequestAnimationFrame ||
	  function (callback) {
		  window.setTimeout(callback, 1000 / 60);
  };
  
  var canvas,
	  ctx,
	  cloth,
	  boundsx,
	  boundsy,
	  mouse = {
		  down: false,
		  button: 1,
		  x: 0,
		  y: 0,
		  px: 0,
		  py: 0
	  };
  
  var Point = function (x, y) {
	  this.x      = x;
	  this.y      = y;
	  this.px     = x;
	  this.py     = y;
	  this.vx     = 0;
	  this.vy     = 0;
	  this.pin_x  = null;
	  this.pin_y  = null;
	  
	  this.constraints = [];
  };
  
  Point.prototype.update = function (delta) {
	  if (mouse.down) {
		  var diff_x = this.x - mouse.x,
			  diff_y = this.y - mouse.y,
			  dist = Math.sqrt(diff_x * diff_x + diff_y * diff_y);
  
		  if (mouse.button == 1) {
			  if (dist < mouse_influence) {
				  this.px = this.x - (mouse.x - mouse.px) * 1.8;
				  this.py = this.y - (mouse.y - mouse.py) * 1.8;
			  }
			
		  } else if (dist < mouse_cut) this.constraints = [];
	  }
  
	  this.add_force(0, gravity);
  
	  delta *= delta;
	  nx = this.x + ((this.x - this.px) * .99) + ((this.vx / 2) * delta);
	  ny = this.y + ((this.y - this.py) * .99) + ((this.vy / 2) * delta);
  
	  this.px = this.x;
	  this.py = this.y;
  
	  this.x = nx;
	  this.y = ny;
  
	  this.vy = this.vx = 0
  };
  
  Point.prototype.draw = function () {
	  if (!this.constraints.length) return;
  
	  var i = this.constraints.length;
	  while (i--) this.constraints[i].draw();
  };
  
  Point.prototype.resolve_constraints = function () {
	  if (this.pin_x != null && this.pin_y != null) {
		  this.x = this.pin_x;
		  this.y = this.pin_y;
		  return;
	  }
  
	  var i = this.constraints.length;
	  while (i--) this.constraints[i].resolve();
  
	  this.x > boundsx ? this.x = 2 * boundsx - this.x : 1 > this.x && (this.x = 2 - this.x);
	  this.y < 1 ? this.y = 2 - this.y : this.y > boundsy && (this.y = 2 * boundsy - this.y);
  };
  
  Point.prototype.attach = function (point) {
	  this.constraints.push(
		  new Constraint(this, point)
	  );
  };
  
  Point.prototype.remove_constraint = function (constraint) {
	  this.constraints.splice(this.constraints.indexOf(constraint), 1);
  };
  
  Point.prototype.add_force = function (x, y) {
	  this.vx += x;
	  this.vy += y;
	
	  var round = 400;
	  this.vx = ~~(this.vx * round) / round;
	  this.vy = ~~(this.vy * round) / round;
  };
  
  Point.prototype.pin = function (pinx, piny) {
	  this.pin_x = pinx;
	  this.pin_y = piny;
  };
  
  var Constraint = function (p1, p2) {
	  this.p1     = p1;
	  this.p2     = p2;
	  this.length = spacing;
  };
  
  Constraint.prototype.resolve = function () {
	  var diff_x  = this.p1.x - this.p2.x,
		  diff_y  = this.p1.y - this.p2.y,
		  dist    = Math.sqrt(diff_x * diff_x + diff_y * diff_y),
		  diff    = (this.length - dist) / dist;
  
	  if (dist > tear_distance) this.p1.remove_constraint(this);
  
	  var px = diff_x * diff * 0.5;
	  var py = diff_y * diff * 0.5;
  
	  this.p1.x += px;
	  this.p1.y += py;
	  this.p2.x -= px;
	  this.p2.y -= py;
  };
  
  Constraint.prototype.draw = function () {
	  ctx.moveTo(this.p1.x, this.p1.y);
	  ctx.lineTo(this.p2.x, this.p2.y);
  };
  
  var Cloth = function () {
	  this.points = [];
  
	  var start_x = canvas.width / 2 - cloth_width * spacing / 2;
  
	  for (var y = 0; y <= cloth_height; y++) {
		  for (var x = 0; x <= cloth_width; x++) {
			  var p = new Point(start_x + x * spacing, start_y + y * spacing);
  
			  x != 0 && p.attach(this.points[this.points.length - 1]);
			  y == 0 && p.pin(p.x, p.y);
			  y != 0 && p.attach(this.points[x + (y - 1) * (cloth_width + 1)])
  
			  this.points.push(p);
		  }
	  }
  };
  
  Cloth.prototype.update = function () {
	  var i = physics_accuracy;
  
	  while (i--) {
		  var p = this.points.length;
		  while (p--) this.points[p].resolve_constraints();
	  }
  
	  i = this.points.length;
	  while (i--) this.points[i].update(.016);
  };
  
  Cloth.prototype.draw = function () {
	  ctx.beginPath();
  
	  var i = cloth.points.length;
	  while (i--) cloth.points[i].draw();
  
	  ctx.stroke();
  };
  
  function update() {
	  ctx.clearRect(0, 0, canvas.width, canvas.height);
  
	  cloth.update();
	  cloth.draw();
  
	  requestAnimFrame(update);
  }
  
  function start() {
	  canvas.onmousedown = function (e) {
		  mouse.button  = e.which;
		  mouse.px      = mouse.x;
		  mouse.py      = mouse.y;
		  var rect      = canvas.getBoundingClientRect();
		  mouse.x       = e.clientX - rect.left,
		  mouse.y       = e.clientY - rect.top,
		  mouse.down    = true;
		  e.preventDefault();
	  };
  
	  canvas.onmouseup = function (e) {
		  mouse.down = false;
		  e.preventDefault();
	  };
  
	  canvas.onmousemove = function (e) {
		  mouse.px  = mouse.x;
		  mouse.py  = mouse.y;
		  var rect  = canvas.getBoundingClientRect();
		  mouse.x   = e.clientX - rect.left,
		  mouse.y   = e.clientY - rect.top,
		  e.preventDefault();
	  };
  
	  canvas.oncontextmenu = function (e) {
		  e.preventDefault();
	  };
  
	  boundsx = canvas.width - 1;
	  boundsy = canvas.height - 1;
  
	  ctx.strokeStyle = '#888';
	
	  cloth = new Cloth();
	
	  update();
  }
  
  window.onload = function () {
	  canvas  = document.getElementById('c');
	  ctx     = canvas.getContext('2d');
  
	  canvas.width  = 560;
	  canvas.height = 350;
  
	  start();
  };
  
 
 
  function readURL(input) {
  if (input.files && input.files[0]) {

    var reader = new FileReader();

    reader.onload = function(e) {
      $('.image-upload-wrap').hide();

      $('.file-upload-image').attr('src', e.target.result);
      $('.file-upload-content').show();

      $('.image-title').html(input.files[0].name);
    };

    reader.readAsDataURL(input.files[0]);

  } else {
    removeUpload();
  }
}

function removeUpload() {
  $('.file-upload-input').replaceWith($('.file-upload-input').clone());
  $('.file-upload-content').hide();
  $('.image-upload-wrap').show();
}
$('.image-upload-wrap').bind('dragover', function () {
		$('.image-upload-wrap').addClass('image-dropping');
	});
	$('.image-upload-wrap').bind('dragleave', function () {
		$('.image-upload-wrap').removeClass('image-dropping');
});
</script>


<style>* {
    margin: 0;
    overflow: hidden;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    -o-user-select: none;
    user-select: none;
}
body {
    background: #F2F2F2;
}
#c {
    display: block;
    margin: 50px auto 0;
}
#info {
    position: absolute;
    left: -1px;
    top: -1px;
    width: auto;
    max-width: 420px;
    height: auto;
    background: #f8f8f8;
    border-bottom-right-radius: 20px;
    border:1px solid #ccc;
}
#top {
    background: #fff;
    width: 100%;
    height: 5px;
    position: relative;
    border-bottom: 1px solid #eee;
}
p {
    font-family: Arial, sans-serif;
    color: #666;
    text-align: justify;
    font-size: 16px;
    margin: 0px 16px;
}
#github, #twitter {
  color:#3377ee;
  font-family: Helvetica, Arial, sans-serif;
  font-size: 14px;
  margin: 0 auto;
  text-align: center;
  text-decoration:none;
}
.center {
  text-align: center;
}
#net {
  text-align:center;
  white-space:nowrap;
  font-size:19px;
  background:rgba(0,0,0,0.1);
  padding:8px 12px;
  border-radius:8px;
  display:block;
  color:#888;
}
#net > span {
  color:#3377ee;
  font-family: Helvetica, Arial, sans-serif;
  font-size: 14px;
  display: block;
  margin: 0 auto;
  text-align: center;
  text-decoration:none;
}
a {
    font-family: sans-serif;
    color: #444;
    text-decoration: none;
    font-size: 20px;
}
#site {
    float: left;
    margin: 10px;
    color: #ff9900;
  border-bottom: 1px dashed #ccc;
  padding-bottom:3px
}
#site:hover {
    color: #ffaa11;
}
#close {
    float: right;
    margin: 10px;
}
#p {
    font-family: Verdana, sans-serif;
    position: absolute;
    right: 10px;
    bottom: 10px;
    color: #4099ff;
    border: 1px dashed #4099ff;
    padding: 4px 8px;
}

#new {
  width: 100%;
  text-align: center;
  font-size: 18px;
  font-family: Helvetica;
  margin-top: 12px;
}

#new a {
  font-size: 20px;
  color: #4099ff;
}

.bull {
  opacity: 0.3;
  margin: 0 6px;
  font-size: 14px;
}




body {
  font-family: sans-serif;
  background-color: #eeeeee;
}

.file-upload {
  background-color: #ffffff;
  width: 300px;
  margin: 0 auto;
  padding: 20px;
}

.file-upload-btn {
  width: 100%;
  margin: 0;
  color: #fff;
  background: #1FB264;
  border: none;
  padding: 10px;
  border-radius: 4px;
  border-bottom: 4px solid #15824B;
  transition: all .2s ease;
  outline: none;
  text-transform: uppercase;
  font-weight: 700;
}

.file-upload-btn:hover {
  background: #1AA059;
  color: #ffffff;
  transition: all .2s ease;
  cursor: pointer;
}

.file-upload-btn:active {
  border: 0;
  transition: all .2s ease;
}

.file-upload-content {
  display: none;
  text-align: center;
}

.file-upload-input {
  position: absolute;
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  outline: none;
  opacity: 0;
  cursor: pointer;
}

.image-upload-wrap {
  margin-top: 10px;
  border: 4px dashed #1FB264;
  position: relative;
}

.image-dropping,
.image-upload-wrap:hover {
  background-color: #1FB264;
  border: 4px dashed #ffffff;
}

.image-title-wrap {
  padding: 0 15px 15px 15px;
  color: #222;
}

.drag-text {
  text-align: center;
}

.drag-text h3 {
  font-weight: 100;
  text-transform: uppercase;
  color: #15824B;
  padding: 60px 0;
}

.file-upload-image {
  max-height: 200px;
  max-width: 200px;
  margin: auto;
  padding: 20px;
}

.remove-image {
  width: 200px;
  margin: 0;
  color: #fff;
  background: #cd4535;
  border: none;
  padding: 10px;
  border-radius: 4px;
  border-bottom: 4px solid #b02818;
  transition: all .2s ease;
  outline: none;
  text-transform: uppercase;
  font-weight: 700;
}

.remove-image:hover {
  background: #c13b2a;
  color: #ffffff;
  transition: all .2s ease;
  cursor: pointer;
}

.remove-image:active {
  border: 0;
  transition: all .2s ease;
}</style>
</body>
</html>